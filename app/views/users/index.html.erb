<div ng:controller="UsersCtrl">

  <ol class="breadcrumb">
    <li><%= link_to 'Home',root_url %></li>
    <li class="active">Our Team</li>
    <% if current_user %>
      <li><%= link_to 'New',new_user_path %></li>
    <% end %>
  </ol>

  <div>
    <h1>Our Team</h1>
  </div>

  <hr>

  <% if current_user %>
  <ul class="pager">
    <li ng:show="!mode.edit"><a href="" ng:click="mode = {edit: true}">Re-Order</a></li>
    <li ng:show="mode.edit && !loading && changed"><a href="" ng:click="saveOrder()">Save</a></li>
    <li ng:show="loading"><a href="" ng:click="">Saving...</a></li>
    <li ng:show="!changed && mode.edit"><a href="" ng:click="mode = {}">Cancel</a></li>
  </ul>
  <% end %>

  <% if current_user %><div ng:show="!mode.edit"><% end %>
  <span ng:init="users = <%= @users.to_json %>"></span>
  <span ng:init="setTeams()"></span>
  
  <div ng:repeat="team in teams">

      <!-- Begin List Group  :-:-:-:-:-:-:-:-:-:-:-:-:-:-:-: -->
      <!-- :-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-: -->
      <div class="list-group">
      
        <!-- Begin List Group Item :-:-:-:-:-:-:-:-:-:-:-:-:-: -->
        <div class="list-group-item active">
          
          <h4 class="list-group-item-heading capitalize">{{team.name}} Team</h4>
        
        </div>
        <!-- End List Group Item :-:-:-:-:-:-:-:-:-:-:-:-:-:-: -->
      
      </div>
      <!-- :-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-: -->
      <!-- End List Group  :-:-:-:-:-:-:-:-:-:-:-:-:-:-:-:-: -->

      <div class="row" ng:repeat="user in team.users">

        <div class="col-md-3">

          <img ng:src="{{user.image.thumb.url}}" class="img-thumbnail" />

          <p>
            <h6 ng:if="user.email"><a href="mailto:{{user.email}}">{{user.email}}</a></h6>
            <h6 ng:if="user.phone"><b>Phone:</b> {{user.phone}}</h6>
            <% if current_user %><h6><b>Public:</b> <b ng:if="user.public">Yes</b><b ng:if="!user.public">No</b></h6><% end %>
          </p>

          <% if current_user %>
          <nav>
            <ul class="pager">
              <li><a href="<%= users_path %>/{{user.id}}/edit">Edit</a></li>
            </ul>
          </nav>
          <% end %>

        </div>

        <div class="col-md-9 profile">

          <h2>{{user.name}}<br><small>{{user.role}}</small></h2>

          <div ng:if="user.description" ng-bind-html="user.description"></div>

        </div>

      </div>

      <hr>

  </div>
  <% if current_user %></div><% end %>

  <% if current_user %>
  <div ng:show="mode.edit">

    <table class="table table-striped table-condensed table-stack-left">
      <tr ng:repeat="user in users" ng:init="user.sort = $index">
        <td width="1">
          <div><a href="" ng:click="moveUser(user,$index,$index-1)"><%= icon 'chevron-up' %></a></div>
          <div><a href="" ng:click="moveUser(user,$index,$index+1)"><%= icon 'chevron-down' %></a></div>
        </td>
        <td width="1" class="vmiddle" class="no-wrap">
          <img ng:src="{{user.image.thumb.url}}" height="40" />
        </td>
        <td class="vmiddle" class="no-wrap">{{user.name}}</td>
      </tr>
    </table>

  </div>
  <% end %>

</div>