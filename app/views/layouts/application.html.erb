<!DOCTYPE html>
<html>
  <head>
    <title>Wilson Investment Properties, Inc</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">
    <link rel="shortcut icon" href="<%= asset_path "favicon-#{Rails.env}.png" %>">
    <%= javascript_include_tag 'application', 'data-turbolinks-track' => true  %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true  %>
    <%= csrf_meta_tags %>
    <% if !current_page?(root_url) %>
      <%images = [{
          main: asset_path('bg-header-apartments.jpg'),
          small: asset_path('bg-header-apartments.jpg'),
          low: asset_path('bg-header-apartments-low.jpg')
        },
        {
          main: asset_path('bg-header-building.jpg'),
          small: asset_path('bg-header-building.jpg'),
          low: asset_path('bg-header-building-low.jpg')
        },
        {
          main: asset_path('bg-header-corporate.jpg'),
          small: asset_path('bg-header-corporate.jpg'),
          low: asset_path('bg-header-corporate-low.jpg')
        },
        {
          main: asset_path('bg-header-small-house.jpg'),
          small: asset_path('bg-header-small-house.jpg'),
          low: asset_path('bg-header-small-house-low.jpg')
        }]
      image = images[Random.rand(0...(images.count-1))]
      %>
      <style type="text/css">
        .jumbotron.home,
        .jumbotron.blue {
          background-image: url(<%= image[:low] %>);
          background-position: center center !important;
        }
      </style>
      <script type="text/javascript">
        <% images.each_with_index do |img,i| %>
          var img_<%= i %> = new Image();
          img_<%= i %>.src = '<%= img[:main] %>';
        <% end %>
        var images = <%= images.shuffle.to_json.html_safe %>;
        var selectedBG = 0;
        var bgTime = 7000;
        setTimeout(function(){
          setInterval(function(){
            var i = (images.length-1) - selectedBG;
            $('.jumbotron.home').css('background-image','url('+images[i].main+')');
            $('.jumbotron.blue').css('background-image','url('+images[i].small+')');
            selectedBG++;
            if (selectedBG >= images.length){ selectedBG = 0 }
          },bgTime);
        },bgTime);
      </script>
      <%
        preload = []
        images.each do |image|
          preload << image[:main]
          preload << image[:small]
        end
      %>
      <style type="text/css">
        body:after{
          position:absolute; width:0; height:0; overflow:hidden; z-index:-1;
          content: <%= preload.map { |image| "url(#{image})" }.join(' ') %>;
        }
      </style>
        <style>
        .topfix .jumbotron.home {
          background-image: url('<%= image[:main] %>');
        }
        .topfix .jumbotron.blue {
          background-image: url('<%= image[:small] %>');
        }
      </style>
    <% end %>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body ng:controller="MainCtrl">
    <% if Rails.env.production? %>
      <div id="placeholder"></div>
      <!-- Google Tag Manager -->
      <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-M29TXX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
      <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-M29TXX');
      //End Google Tag Manager

      // Google Analytics
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-90870046-1', 'auto');
        ga('send', 'pageview');
      </script>
    <% end %>
    <%= render 'shared/flash_messages'%>
    <%= render 'layouts/header' %>
      <%= yield %>
    <%= render 'layouts/footer' %>
  </body>
</html>